{% extends "base.html" %}

{% block title %}Artworks - Art Gallery{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">
        <i class="fas fa-image"></i> Artworks
    </h1>
    <a href="{{ url_for('add_artwork') }}" class="btn btn-primary">
        <i class="fas fa-plus"></i> Add Artwork
    </a>
</div>

<div class="search-box">
    <input type="text" id="searchInput" placeholder="Search artworks..." onkeyup="searchTable()">
    <i class="fas fa-search"></i>
</div>

<div class="table-container">
    <table class="data-table" id="artworksTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Artist</th>
                <th>Type</th>
                <th>Year</th>
                <th>Price</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% if artworks %}
                {% for artwork in artworks %}
                <tr>
                    <td>{{ artwork.artwork_id }}</td>
                    <td><strong>{{ artwork.Title }}</strong></td>
                    <td>{{ artwork.artist_name or 'Unknown' }}</td>
                    <td>{{ artwork.Type }}</td>
                    <td>{{ artwork.creation_yr }}</td>
                    <td class="price">${{ "{:,.2f}".format(artwork.price) if artwork.price else '0.00' }}</td>
                    <td class="action-buttons">
                        <a href="{{ url_for('edit_artwork', artwork_id=artwork.artwork_id) }}" class="btn btn-sm btn-edit" title="Edit">
                            <i class="fas fa-edit"></i>
                        </a>
                        <form action="{{ url_for('delete_artwork', artwork_id=artwork.artwork_id) }}" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this artwork?');">
                            <button type="submit" class="btn btn-sm btn-delete" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="7" class="no-data">No artworks found. <a href="{{ url_for('add_artwork') }}">Add your first artwork</a></td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}

{% block extra_js %}
<script>
function searchTable() {
    const input = document.getElementById('searchInput');
    const filter = input.value.toUpperCase();
    const table = document.getElementById('artworksTable');
    const tr = table.getElementsByTagName('tr');

    for (let i = 1; i < tr.length; i++) {
        const td = tr[i].getElementsByTagName('td');
        let found = false;
        
        for (let j = 0; j < td.length - 1; j++) {
            if (td[j]) {
                const txtValue = td[j].textContent || td[j].innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    found = true;
                    break;
                }
            }
        }
        
        tr[i].style.display = found ? '' : 'none';
    }
}
</script>
{% endblock %}
